# find-and-block-trafic
Техническая задача: Обнаружение и блокировка подозрительного сетевого трафика

Описание:
Вам предстоит разработать простой механизм обнаружения и блокировки подозрительного сетевого трафика на основе определенных правил и сигнатур.

Шаги:
1. Установка необходимых библиотек:
   Установите библиотеку Scapy, которая позволит вам анализировать сетевой трафик и взаимодействовать с сетевыми пакетами на Python.

2. Создание скрипта для обнаружения и анализа трафика:
   Напишите скрипт на Python, который будет слушать сетевой трафик и анализировать его с помощью Scapy. Вы можете определить правила обнаружения на основе различных параметров пакетов, таких как IP-адреса, порты, заголовки и т. д.

3. Определение подозрительного трафика:
   Ваш скрипт должен содержать логику определения подозрительного трафика на основе заданных правил. Например, вы можете искать аномально большие пакеты, сканирование портов, повторяющиеся запросы и т. д.

4. Блокировка подозрительного трафика:
   После обнаружения подозрительного трафика ваш скрипт должен принимать меры по его блокировке. Например, вы можете отправлять ICMP сообщения о недостижимости (ICMP Destination Unreachable) для блокировки конкретных IP-адресов или портов.

5. Тестирование и настройка:
   Протестируйте ваш скрипт на различных видах сетевого трафика и убедитесь, что он обнаруживает и блокирует подозрительные активности в соответствии с вашими ожиданиями. Настройте параметры скрипта для оптимальной работы.

6. Непрерывное обновление и мониторинг:
   Поддерживайте ваш скрипт в актуальном состоянии, обновляя правила обнаружения и блокировки в соответствии с новыми угрозами и сценариями атак. Мониторьте его работу и анализируйте логи для выявления аномалий.

7. Графический Интерфейс:
   Разработать графический интерфейс для удобного взаимодействия с приложением.
   Предоставить интуитивно понятный и информативный вывод результатов.

## Требования
- Python 3.9+
- Права суперпользователя/администратора для сниффинга и firewall
- Linux: iptables установлен
- Windows: Npcap, запуск от администратора
- macOS: настройка pf (таблица suspicious)

## Возможности
- Сниффинг сети (Scapy)
- Обнаружение:
    - Большие пакеты
    - Сканирование портов
    - Высокая частота (rate flood)
    - Сигнатуры полезной нагрузки (регекс)
    - Подозрительные HTTP User-Agent
    - Массовые повторения HTTP пути
- Блокировка:
    - Через iptables (Linux)
    - Через netsh (Windows)
    - Через pfctl (macOS, требует настроек)
    - Опционально ICMP Destination Unreachable
- GUI на PyQt5:
    - Таблица пакетов
    - События
    - Динамическое изменение порогов
    - Ручная блокировка IP
    - Сохранение и перезагрузка config.yaml

## Установка
```bash
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt
sudo python app/main.py   # или py app/main.py (Windows с админ правами)
```

## Пример обновления правил
Редактируйте `config.yaml`, затем нажмите в GUI "Перезагрузить правила".

## Дополнительно
- Логирование в папку `logs/`
- Можно расширить detector.py для:
    - Корреляции по TCP флагам (SYN flood)
    - DNS анализ (поддомены)
    - GeoIP

## Ограничения
- Невозможно «гарантированно» остановить трафик только ICMP unreachable.
- HTTPS не анализируется содержательно (шифрование).
- Некоторые пакеты могут быть пропущены на высоких скоростях (Python/Scapy ограничение).

## Безопасность
Запускайте только на своих системах. Убедитесь в правовом соответствии мониторинга.

## Мониторинг вашего сайта (91.226.80.174)
IP добавлен в protected_ips — можно расширить логику (например, выделять события, направленные на этот IP).